{% load static %}
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		{% comment %} <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous" /> {% endcomment %}
		
		{% comment %} Bootstrap {% endcomment %}
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
		
		{% comment %} Icons {% endcomment %}
		{% comment %} <script src="https://kit.fontawesome.com/329d00895b.js" crossorigin="anonymous"></script> {% endcomment %}
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
		
		{% comment %} Custom CSS {% endcomment %}
		<link rel="stylesheet" type="text/css" href="{% static 'network/main.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'network/styles.css' %}" />

		<link rel="icon" type="image/png" href="{% static 'network/logo.png' %}" />
		{% comment %} <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /> {% endcomment %}
		{% comment %} <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-zrnmn8R8KkWl12rAZFt4yKjxplaDaT7/EUkKm7AovijfrQItFWR7O/JJn4DAa/gx" crossorigin="anonymous" /> {% endcomment %}
		<title>CS50 Tweets</title>
	</head>
	<body >

	<main role="main" class="container-fluid d-flex flex-column min-vh-100">
		<div class="container-fluid">
			<div class="row">
	
				{% comment %} RIGHT COLUMN {% endcomment %}
				<div class="col-3 left-column">	
					<div class="row">
						{% comment %} Menu {% endcomment %}
						<div class="col-12">
							<header class="site-header">
								<!-- Navbar brand -->
								<a class="navbar-brand" href="/"> 
									<h2>
										<img class="d-inline-block align-text-center" width="50" src="{% static 'network/logo.png' %}" />
										CS50W Social Network
									</h2>
								</a>
								<!-- Left links -->
								<ul class="navbar-nav me-auto mb-2 mb-lg-0">
									<li class="nav-item">						
										<a class="nav-link" href="{% url 'home' %}">
											<i class="fas fa-home"></i>
											Home
										</a>
									</li>
									{% if user.is_authenticated %} 
										<li class="nav-item">						
											<a class="nav-link" href="{% url 'post-create' %}">
												<i class="far fa-edit"></i>
												Create a Post
											</a>
										</li>
									{% endif %}
									
									{% if user.is_authenticated %} 
										<li class="nav-item">						
											<a class="nav-link" href="{% url 'profile' %}">
												<i class="far fa-id-card"></i>
												Profile
											</a>
										</li>
									{% endif %}

									{% if user.is_authenticated %} 
										<li class="nav-item">
											<a class="nav-link" href="{% url 'logout' %}">
												<i class="fas fa-sign-out-alt"></i>
												Logout
											</a>
										</li>
									{% else %}
										<li class="nav-item">
											<a class="nav-link" href="{% url 'login' %}">
												<i class="fas fa-user"></i>
												Login
											</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" href="{% url 'register-users' %}">
												<i class="fas fa-user-plus"></i>
												Register
											</a>
										</li>
									{% endif %}
									
									<li class="nav-item">
										<a class="nav-link" href="{% url 'about' %}">
											<i class="fas fa-question"></i>
											About
										</a>
									</li>
								</ul>

							</header>
						</div>
					</div>

					{% comment %} Profile {% endcomment %}
					<div class="row">
						<div class="col-12 pt-4">
							{% if user.is_authenticated %} 
								<div class="profile-section">
									<article class="content-section">
										
										{% comment %} Profile {% endcomment %}
										<div class="row">
											<div class="col-12">
												<h4 class="white-important p-2">Profile</h4>
											</div>
											<div class="col-12">
												<div class="row">
													<div class="col-4">
														<div>
															{% if user_profile != None %}
																<img class="rounded-circle mr-3 img-fluid" style="width: 90px; height: 90px" src="{{ user_profile.profile.image.url }}"/>
															{% else %}
																<img class="rounded-circle mr-3 img-fluid" style="width: 90px; height: 90px" src="{{ user.profile.image.url }}"/>
															{% endif %}
														</div>
													</div>
													<div class="col-8">
														<div>
															{% if user_profile != None %}
																<h4 style="text-align: left" class="white-important">{{ user_profile.username }}</h4>
															{% else %}
																<h4 style="text-align: left" class="white-important">{{ user.username }}</h4>
															{% endif %}															
														</div>
														<div>
															{% if user_profile != None %}
																<h6 style="text-align: left" class="email-profile">{{ user.email }}</h6>
															{% else %}
																<h6 style="text-align: left" class="email-profile">{{ user.email }}</h6>
															{% endif %}
															
														</div>
													</div>
												</div>
											</div>
										</div>
									
										{% comment %} Following / Followers {% endcomment %}
										<div class="row mt-4"> 
											<div class="col-6">
												<h5>Followers</h5>
											</div>
											<div class="col-6">
												<h5>Following</h5>
											</div>	
										</div>	
										<div class="row">
											<div class="col-6">
												{% if user_profile != None %}
													<a href="{% url 'user-followers' user_profile.username %}">
														<h3 class="white-important follow-click">{{ user_profile.profile.followers }}</h3>
													</a>
												{% else %}
													<a href="{% url 'user-followers' user.username %}">
														<h3 class="white-important follow-click">{{ user.profile.followers }}</h3>
													</a>
												{% endif %}
											</div>
											<div class="col-6">
												{% if user_profile != None %}
													<a href="{% url 'user-follows' user_profile.username %}">
														<h3 class="white-important follow-click">{{ user_profile.profile.following }}</h3>
													</a>
												{% else %}
													<a href="{% url 'user-follows' user.username %}">
														<h3 class="white-important follow-click">{{ user.profile.following }}</h3>
													</a>
												{% endif %}
											</div>
										</div>
									
										{% comment %} Tweet / Follow / Unfollow Buttons {% endcomment %}
										<div class="row mt-4">
											<div class="col-12 ">
												{% if user_profile is None %}
													<a class="btn btn-sm btn-outline-primary mb-4 mr-3" href="{% url 'post-create' %}"> Tweet </a>
												{% else %}
													{% if user_profile is not None and user_profile.id != user.id and user.username != '' %}
														<form method="POST">
															{% csrf_token %}
															<div class="form-group">
																<button style="margin-left: 18px" class="btn btn-sm btn-outline-primary"
																	name="{% if can_follow %}follow{% else %}unfollow{% endif %}" type="submit">
																	{% if can_follow %} FOLLOW {% else %} UNFOLLOW {% endif %}
																</button>
															</div>
														</form>
													{% endif %}
												{% endif %} 
											</div>
										</div>
									</article>	

								</div>
							{% endif %}
						</div>
					</div>

				</div>


				{% comment %} CENTER COLUMN {% endcomment %}
				<div class="col-6 center-column">
					{% comment %} If there is messages to show to the user. {% endcomment %}
					{% if messages %} 
						{% for message in messages %}
							{% if message.tags == 'error' %}
								<div class="alert alert-danger">
									{{ message }}
								</div>
							{% else %}
								{% if message.tags == 'debug' %} 
									<div class="alert alert-warning">
										{{ message }}
									</div>
								{% else %}
									{% comment %} Otherwise {% endcomment %}
									<div class="alert alert-{{ message.tags }}">
										{{ message }}
									</div>
								{% endif %} 
							{% endif %} 		
						{% endfor %} 
					{% endif %} 

					{% comment %} Main Central Content {% endcomment %}
					{% block content %}
					{% endblock %}
				</div>


				{% comment %} RIGHT COLUMN {% endcomment %}
				<div class="col-3 right-column">
					{% comment %} {% block right_content %}
					{% endblock %} {% endcomment %}

					{% comment %} Search Area {% endcomment %}
					
						<div class="col-12">
							<form action="{% url 'search' %}" method="post">
								{% csrf_token %}
								<div class="search-container">
									<div class="search">
										<input required name="search" type="text" id="searchInput" placeholder="Search Network" />
										<button type="submit" style="border: 0; background: transparent">
											<i class="fa fa-search"></i>
										</button>
									</div>
								</div>
							</form>
						</div>

					{% if user.is_authenticated %} 
						{% comment %} Trends and Who to Follow {% endcomment %}
						<h3 class="white-important mb-3 mt-4">Trends??</h3>
						{% if user_profile is None %}
							<article class="t-section media content-section">
								<div class="row">
									<div class="col-12">
										<h4>Who to follow</h4>
									</div>
								</div>
								<div class="row">
									<div style="color: red">(excluir eu mesmo)</div>
									<ul>
										{% for user in all_users %}											
											<li>
												<div class="who-to-follow">
													<div class="row">
														<div class="col-12">
															<div class="d-inline">
																<img class="rounded-circle mr-2" style="width: 20px; height: 20px" src="{{ user.profile.image.url }}" />
															</div>
															<div class="d-inline">
																<a class="mr-2 white-important" href="{% url 'user-posts' user.username %}">
																	{{ user.username }}
																</a>
															</div>
														</div>
														<div class="col-12">
															<p>{{ user.email }}</p>
														</div>
													</div>
												</div>
											</li>
										{% endfor %}
									</ul>
								</div>
							</article>
						{% endif %} 
					{% endif %} 



				</div>

			</div>
		</div>
	</main>

	<footer class="footer mt-auto py-3">
		<hr/>
		<div class="container-fluid">
		<div class="row">
			<div class="col-12">
				<span class="text-muted">
					<p>
					<a href="">Terms</a>, <a href="">Privacy policy</a>, <a href="">Cookies</a>, <a href="">Ads info</a>,
					<a href="">More</a> Â© 2021 CS50W Harvard.
					</p>
				</span>
			</div>
		</div>
	</footer>

	<!-- Javascript libs -->
	<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

	<script src="{% static "JSUtils.js" %}" type="text/javascript"></script>
	</body>
</html>
